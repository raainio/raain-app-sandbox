"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1052],{1052:(C,f,c)=>{c.r(f),c.d(f,{RadarsPageModule:()=>I});var m=c(6895),g=c(433),e=c(4556),u=c(1407),d=c(5861),p=c(4718),i=c(8256),h=c(6568);function Z(r,s){if(1&r){const t=i.EpF();i.TgZ(0,"ion-card",5)(1,"ion-card-header")(2,"ion-card-title"),i._uU(3,"Your radars"),i.qZA(),i.TgZ(4,"ion-card-subtitle"),i._uU(5," Radars information "),i.qZA()(),i.TgZ(6,"ion-card-content")(7,"p"),i._uU(8,"Manage here your radar status."),i.qZA()(),i.TgZ(9,"ion-button",6),i.NdJ("click",function(){i.CHM(t);const n=i.oxw();return i.KtG(n.closeInfo("welcome-card"))}),i._uU(10,"Got it"),i.qZA()()}}function x(r,s){if(1&r){const t=i.EpF();i.TgZ(0,"ion-label",16),i.NdJ("click",function(){i.CHM(t);const n=i.oxw().$implicit,o=i.oxw(2);return i.KtG(o.navigateToZone(n))}),i._uU(1," Rain zone attached "),i.qZA()}}function T(r,s){if(1&r){const t=i.EpF();i.TgZ(0,"ion-icon",17),i.NdJ("click",function(){i.CHM(t);const n=i.oxw().$implicit,o=i.oxw(2);return i.KtG(o.navigateToZone(n))}),i.qZA()}}function k(r,s){if(1&r){const t=i.EpF();i.TgZ(0,"ion-icon",18),i.NdJ("click",function(){i.CHM(t);const n=i.oxw().$implicit,o=i.oxw(2);return i.KtG(o.navigateToZone(n))}),i.qZA()}}function R(r,s){if(1&r){const t=i.EpF();i.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",19)(3,"ion-button",20),i.NdJ("click",function(){i.CHM(t);const n=i.oxw().$implicit,o=i.oxw(2);return i.KtG(o.saveRadar(n))}),i._uU(4,"Save"),i.qZA()()()(),i.TgZ(5,"ion-content",21)(6,"ion-item")(7,"ion-input",22),i.NdJ("ngModelChange",function(n){i.CHM(t);const o=i.oxw().$implicit;return i.KtG(o.name=n)}),i.qZA()()()}if(2&r){const t=i.oxw().$implicit;i.xp6(3),i.Q6J("strong",!0),i.xp6(4),i.Q6J("ngModel",t.name)}}function y(r,s){if(1&r){const t=i.EpF();i.TgZ(0,"ion-item-sliding")(1,"ion-item-options",8)(2,"ion-item-option",9),i.NdJ("click",function(){const o=i.CHM(t).$implicit,l=i.oxw(2);return i.KtG(l.deleteRadar(o))}),i._uU(3," Delete "),i.qZA()(),i.TgZ(4,"ion-item"),i._UZ(5,"ion-icon",10),i.TgZ(6,"ion-button",11),i._uU(7),i.qZA(),i.YNc(8,x,2,0,"ion-label",12),i.YNc(9,T,1,0,"ion-icon",13),i.YNc(10,k,1,0,"ion-icon",14),i.qZA(),i.TgZ(11,"ion-modal",15),i.NdJ("willDismiss",function(){const o=i.CHM(t).$implicit,l=i.oxw(2);return i.KtG(l.saveRadar(o))}),i.YNc(12,R,8,2,"ng-template"),i.qZA()()}if(2&r){const t=s.$implicit;i.xp6(6),i.MGl("id","open-modal-radar#",t.id,""),i.xp6(1),i.AsE("",t.name," ",t.description," "),i.xp6(1),i.Q6J("ngIf",null==t.zones?null:t.zones.length),i.xp6(1),i.Q6J("ngIf",(null==t.zones?null:t.zones.length)&&!t.hasSomeData),i.xp6(1),i.Q6J("ngIf",(null==t.zones?null:t.zones.length)&&t.hasSomeData),i.xp6(1),i.MGl("trigger","open-modal-radar#",t.id,"")}}function w(r,s){if(1&r&&(i.TgZ(0,"ion-list"),i.YNc(1,y,13,7,"ion-item-sliding",7),i.qZA()),2&r){const t=i.oxw();i.xp6(1),i.Q6J("ngForOf",t.radars)}}let A=(()=>{const s=class{constructor(a,n){this.profile=a,this.router=n,this.radarsInfoAlreadyViewed={},this.radars=[]}ngOnInit(){this.refresh()}refresh(a){var n=this;return(0,d.Z)(function*(){try{n.sessionData=yield n.profile.refreshProfile(),n.sessionData.infos.radarsInfoAlreadyViewed&&(n.radarsInfoAlreadyViewed=n.sessionData.infos.radarsInfoAlreadyViewed),n.radars=yield n.profile.getRadars(n.profile.asTeamId);for(const o of n.radars){const l=yield n.getLinkedZones(o);if(l.length){const _=yield n.profile.getRainTimeframe(l[0],new Date("2018-01-01"),new Date("2030-01-01"));o.hasSomeData=_&&_.getLinksCount(p.RadarMeasure.TYPE)&&_.getLinksCount(p.RainComputation.TYPE)}}}catch(o){console.error("refresh  pb:",o)}a&&a.target.complete()})()}closeInfo(a){var n=this;return(0,d.Z)(function*(){n.radarsInfoAlreadyViewed[a]=!0,n.sessionData&&n.sessionData.infos&&(n.sessionData.infos.radarsInfoAlreadyViewed=n.radarsInfoAlreadyViewed,yield n.profile.storeAll())})()}deleteRadar(a){}getLinkedZones(a){return(0,d.Z)(function*(){const n=a.getLinksCount("rain"),o=[];for(let l=0;l<n;l++){const _=a.getLink("rain",l);o.push(_.getId())}return o})()}navigateToZone(a){var n=this;return(0,d.Z)(function*(){return n.router.navigate(["/rains",a.getLinkId("rain",0)])})()}saveRadar(a){var n=this;return(0,d.Z)(function*(){yield n.profile.putRadar(a),yield n.refresh(),yield n.modal.dismiss()})()}};let r=s;return s.\u0275fac=function(n){return new(n||s)(i.Y36(h.H),i.Y36(u.F0))},s.\u0275cmp=i.Xpm({type:s,selectors:[["app-radars"]],viewQuery:function(n,o){if(1&n&&i.Gf(e.ki,5),2&n){let l;i.iGM(l=i.CRH())&&(o.modal=l.first)}},decls:12,vars:2,consts:[["slot","start"],["src","assets/icon/favicon.ico",2,"height","30px","padding-left","20px"],["slot","fixed",3,"ionRefresh"],["class","welcome-card",4,"ngIf"],[4,"ngIf"],[1,"welcome-card"],["fill","outline",3,"click"],[4,"ngFor","ngForOf"],["side","start"],["color","danger","expandable","true",3,"click"],["color","primary","name","wifi","slot","start"],["expand","block","fill","clear",3,"id"],["slot","end",3,"click",4,"ngIf"],["color","primary","name","checkmark-circle","slot","end",3,"click",4,"ngIf"],["color","success","name","checkmark-circle","slot","end",3,"click",4,"ngIf"],[3,"trigger","willDismiss"],["slot","end",3,"click"],["color","primary","name","checkmark-circle","slot","end",3,"click"],["color","success","name","checkmark-circle","slot","end",3,"click"],["slot","end"],[3,"strong","click"],[1,"ion-padding"],["type","text",3,"ngModel","ngModelChange"]],template:function(n,o){1&n&&(i.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),i._UZ(3,"ion-menu-button")(4,"ion-img",1),i.qZA(),i.TgZ(5,"ion-title"),i._uU(6," Radars "),i.qZA()()(),i.TgZ(7,"ion-content")(8,"ion-refresher",2),i.NdJ("ionRefresh",function(_){return o.refresh(_)}),i._UZ(9,"ion-refresher-content"),i.qZA(),i.YNc(10,Z,11,0,"ion-card",3),i.YNc(11,w,2,1,"ion-list",4),i.qZA()),2&n&&(i.xp6(10),i.Q6J("ngIf",!o.radarsInfoAlreadyViewed.hasOwnProperty("welcome-card")),i.xp6(1),i.Q6J("ngIf",o.radars))},dependencies:[m.sg,m.O5,g.JJ,g.On,e.YG,e.Sm,e.PM,e.FN,e.Zi,e.tO,e.Dq,e.W2,e.Gu,e.gu,e.Xz,e.pK,e.Ie,e.u8,e.IK,e.td,e.Q$,e.q_,e.fG,e.nJ,e.Wo,e.wd,e.sr,e.ki,e.j9],styles:[".content-card[_ngcontent-%COMP%]{margin-bottom:100px}ion-list[_ngcontent-%COMP%]{margin-bottom:50px}"]}),r})(),I=(()=>{const s=class{};let r=s;return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=i.oAB({type:s}),s.\u0275inj=i.cJS({imports:[m.ez,g.u5,e.Pc,u.Bz.forChild([{path:"",component:A}])]}),r})()}}]);